<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Music Player</title>
    <style>
    body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #2c3e50, #34495e);
        color: #ecf0f1;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
    }

    .music-player {
        background: #1e272e;
        padding: 20px 25px;
        border-radius: 16px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        width: 360px;
        text-align: center;
    }

    .music-player h2 {
        margin-bottom: 15px;
        font-size: 1.4rem;
        color: #f1c40f;
    }

    .seekbar-container {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 6px;
        margin-bottom: 15px;
    }

    #seekbar {
        flex: 1;
        accent-color: #f1c40f;
    }

    #current-time, #total-time {
        font-size: 0.9rem;
        color: #bdc3c7;
    }

    .btn-container {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    .btn-seek-container, .btn-volume-container {
        display: flex;
        justify-content: center;
        gap: 10px;
        flex-wrap: wrap;
    }

    button {
        background: #2c3e50;
        color: #ecf0f1;
        border: none;
        padding: 8px 14px;
        border-radius: 8px;
        cursor: pointer;
        transition: 0.2s;
        font-size: 0.9rem;
    }

    button:hover {
        background: #f1c40f;
        color: #2c3e50;
    }

    #loop-btn {
        font-weight: bold;
    }

    #loop-btn.active {
        background: #27ae60;
        color: white;
    }

    #section-btn {
        font-weight: bold;
    }

    #section-btn.start {
        background: #366aa6;
        color: white;
    }
    #section-btn.end {
        background: #27ae60;
        color: white;
    }

    #volume-bar {
        width: 100px;
        accent-color: #f1c40f;
    }

    #volume-value {
        min-width: 30px;
        text-align: right;
    }

    select { 
        margin: 5px;
        padding: 6px 12px;
    }

    .file-container {
        margin-top: 15px;
    }

    .file-input {
        color: #bdc3c7;
        font-size: 0.9rem;
    }

    ul { 
        list-style: none; 
        padding: 0; 
        margin-top: 20px; 
        border-top: 1px solid #ccc;
    }

    li { 
        cursor: pointer; 
        padding: 8px; 
        border-bottom: 1px solid #eee; }

    li:hover { 
        background: #f1c40f;
        color: #2c3e50;
    }

    li.active { 
        background-color: #0b9adc; 
        font-weight: bold;
    }

    #file-list {
        list-style: none;
        padding: 0;
        margin-top: 20px;
        border-top: 1px solid #ccc;
        max-height: 600px;
        overflow-y: auto;
        text-align: center;
    }

    </style>
</head>
<body>
    <div class="music-player">
        <h2>Music Player</h2>
        <p id="file-name">no file</p>
        <audio src="" id="audio"></audio>

        <div class = "seekbar-container">
            <input type="range" id="seekbar" value="0" min="0" step="1">
            <span id="current-time">00:00</span>
            /
            <span id="total-time">00:00</span>
        
        </div>
        <div class="btn-container">
            <div class="btn-seek-container">
                <!-- <button id="prev-btn">‚èÆÔ∏è Ïù¥Ï†Ñ</button> -->
                <button id="backward-btn">‚è™ 3Ï¥à</button>
                <button id="play-pause-btn">‚ñ∂Ô∏è Play</button>
                <button id="forward-btn">‚è© 3Ï¥à</button>
                <!-- <button id="next-btn">‚è≠Ô∏è Îã§Ïùå</button> -->
                <button id="loop-btn">üîÅ Loop</button>
                <button id="section-btn">üîÅ A-B Î∞òÎ≥µ</button>
            </div>
            <div class="btn-volume-container">
                <button id="mute-btn">üîä</button>
                <input type="range" id="volume-bar" min="0" max="1" step="0.01" value="0.5">
                <span id="volume-value">50</span>
            </div>
            <div class="speed-control-container">
                <label for="speed-control">Ïû¨ÏÉù ÏÜçÎèÑ</label>
                <select id="speed-control">
                    <option value="0.5">0.5x</option>
                    <option value="0.75">0.75x</option>
                    <option value="1" selected>1x (Í∏∞Î≥∏)</option>
                    <option value="1.25">1.25x</option>
                    <option value="1.5">1.5x</option>
                    <option value="2">2x</option>
                </select>
            </div>
        </div>
        

        <div class="file-container">
            <input type="file" id="file-input" class="file-input" multiple accept="audio/*" >
            <!-- <div class="file-input" onclick="document.getElementById('fileInput').click()">
                üìÅ ÏùåÏïÖ ÌååÏùº Ï∂îÍ∞ÄÌïòÍ∏∞ (ÌÅ¥Î¶≠ ÎòêÎäî ÎìúÎûòÍ∑∏)
            </div> -->
        </div>

        <div id="file-list"></div>

    </div>

    <script>
        const initialDisplay = () => {
            playBtn.textContent = "Play";
        };

        /* play && pause */
        const audio = document.querySelector("#audio");
        const playBtn = document.querySelector("#play-pause-btn");

        playBtn.addEventListener("click", () => {
            if (audio.paused) {
                audio.play();
                playBtn.textContent = "Pause";
            } else {
                audio.pause();
                playBtn.textContent = "Play";
            }
        });

        /* seekbar Time */
        const seekbar = document.querySelector("#seekbar");
        const currentTime = document.querySelector("#current-time");
        const totalTime = document.querySelector("#total-time");

        const formatTime = (time) => {
            const minute = String(Math.floor((time / 60) % 60)).padStart(2, '0');
            const second = String(Math.floor(time % 60)).padStart(2, '0');
            return `${minute}: ${second}`
        };

        // Ï†ÑÏ≤¥Í∏∏Ïù¥ ÌëúÏãú
        audio.addEventListener('loadedmetadata', () => {
            seekbar.max = Math.floor(audio.duration);
            totalTime.textContent = formatTime(audio.duration);
        });

        // // Ïû¨ÏÉùÏúÑÏπò ÏóÖÎç∞Ïù¥Ìä∏
        // audio.addEventListener('timeupdate', () => {
        //     seekbar.value = Math.floor(audio.currentTime);
        //     currentTime.textContent = formatTime(audio.currentTime);
        // });

        // ÏãúÌÅ¨Î∞î Ïù¥Îèô
        seekbar.addEventListener('input', () => {
            audio.currentTime = parseInt(seekbar.value);
            seekbar.value = Math.floor(audio.currentTime);
            currentTime.textContent = formatTime(audio.currentTime);
        });

        /* Volume */
        const volumeBar = document.querySelector("#volume-bar");
        const volumeValue = document.querySelector("#volume-value");
        const muteBtn = document.querySelector("#mute-btn");

        const formatVolume = (volume) => {
            const volumeValue = String(Math.floor(volume * 100)).padStart(2, '0');
            return `${volumeValue}`;
        };

        // Î≥ºÎ•® Ï°∞Ï†à
        volumeBar.addEventListener('input', () => {
            audio.volume = volumeBar.value;
            if (audio.volume === 0) {
                muteBtn.textContent = "üîá";
            } else {
                muteBtn.textContent = "üîä";
            }
            volumeValue.textContent = formatVolume(volumeBar.value);
        });

        // ÏùåÏÜåÍ±∞
        muteBtn.addEventListener("click", () => {
            audio.muted = !audio.muted;
            muteBtn.textContent = audio.muted ? "üîá" : "üîä";
            volumeBar.value = audio.muted ? 0 : audio.volume;
            volumeValue.textContent = formatVolume(volumeBar.value);
        });

        /* Ïù¥ÎèôÍ∏∞Îä• */
        const forwardBtn = document.querySelector("#forward-btn");
        const backwardBtn = document.querySelector("#backward-btn");

        forwardBtn.addEventListener("click", () => {
            audio.currentTime = parseInt(seekbar.value) + 3;
            if (audio.currentTime >= audio.duration) {
                audio.currentTime = audio.duration;
            }
            seekbar.value = Math.floor(audio.currentTime);
            currentTime.textContent = formatTime(audio.currentTime);
        });

        backwardBtn.addEventListener("click", () => {
            audio.currentTime = parseInt(seekbar.value) - 3;
            if (audio.currentTime <= 0) {
                audio.currentTime = 0;
            }
            seekbar.value = Math.floor(audio.currentTime);
            currentTime.textContent = formatTime(audio.currentTime);
        });

        /* Î∞òÎ≥µ Í∏∞Îä• */
        const loopBtn = document.querySelector("#loop-btn");
        let loopMode = 0;
        
        // ÌïúÍ≥° Î∞òÎ≥µ Í∏∞Îä•
        loopBtn.addEventListener("click", () => {
            if (loopMode == 0) {
                loopMode = 1;
                audio.loop = true;
                loopBtn.classList.toggle("active", true);
            } else {
                loopMode = 0;
                audio.loop = false;
                loopBtn.classList.toggle("active", false);
            }
        });

        /* File Open */
        const fileInput = document.querySelector("#file-input");
        const fileName = document.querySelector("#file-name");
        const fileList = document.querySelector("#file-list");
        let playList = [];
        let currentIndex = -1;

        // ÌååÏùº ÌïòÎÇò Ïó¥Í∏∞
        // fileInput.addEventListener("change", (e) => {
        //     audio.src = URL.createObjectURL(e.target.files[0]);
        //     fileName.textContent = e.target.files[0].name;
        //     initialDisplay();
        // });

        // ÌååÏùº Ïó¨Îü¨Í∞ú Ïó¥Í∏∞
        fileInput.addEventListener('change', (e) => {
            playList = Array.from(e.target.files);
            currentIndex = 0;
            renderPlaylist();
            if (playList.length > 0) {
                playTrack(currentIndex);
            }
            initialDisplay();
        });

        const renderPlaylist = () => {
            fileList.innerHTML = '';
            playList.forEach((file, index) => {
                const li = document.createElement('li');
                li.textContent = file.name;
                if (index === currentIndex) li.classList.add('active');
                li.addEventListener('click', () => {
                playTrack(index);
                });
                fileList.appendChild(li);
            });
        };

        const playTrack = (index) => {
            if (index < 0 || index >= playList.length) return;
            currentIndex = index;
            audio.src = URL.createObjectURL(playList[currentIndex]);
            fileName.textContent = `üéµ Ïû¨ÏÉù Ï§ë: ${playList[currentIndex].name}`;
            audio.play();
            renderPlaylist();
        }

        /* Íµ¨Í∞Ñ Î∞òÎ≥µ */
        const sectionBtn = document.querySelector("#section-btn");
        let sectionState = 0;
        let startTime = 0;
        let endTime = 0;

        const setSectionStart = () => {
            startTime = audio.currentTime;
            sectionState = 1;
            sectionBtn.classList.add("start");
        };

        const setSectionEnd = () => {
            endTime = audio.currentTime;
            sectionState = 2;
            sectionBtn.classList.add("end");
        };

        const clearSection = () => {
            startTime = 0;
            endTime = 0;
            sectionState = 0;
            sectionBtn.classList.remove("start");
            sectionBtn.classList.remove("end");
        };

        sectionBtn.addEventListener("click", () => {
            if (sectionState === 0) {
                setSectionStart();
            } else if (sectionState === 1) {
                setSectionEnd();
            } else if (sectionState === 2) {
                clearSection();
            }
        });

        // Ïû¨ÏÉùÏúÑÏπò ÏóÖÎç∞Ïù¥Ìä∏
        audio.addEventListener('timeupdate', () => {
            if (sectionState === 2 && audio.currentTime >= endTime) {
                audio.currentTime = startTime;
            }
            seekbar.value = Math.floor(audio.currentTime);
            currentTime.textContent = formatTime(audio.currentTime);
        });

        /* Ïû¨ÏÉùÏÜçÎèÑ Ï°∞Ï†à */
        const speedControlBtn = document.querySelector("#speed-control");

        speedControlBtn.addEventListener("change", () => {
            audio.playbackRate = parseFloat(speedControlBtn.value);
        });

        /* shortcut */
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                playBtn.click();
            } else if (e.code === 'ArrowLeft') {
                backwardBtn.click();
            } else if (e.code === 'ArrowRight') {
                forwardBtn.click();
            } else if (e.code === 'KeyL') {
                loopBtn.click();
            } else if (e.code === 'KeyT') {
                sectionBtn.click();
            } else if (e.code === 'KeyM') {
                muteBtn.click();
            } else if (e.code === 'KeyO') {
                fileInput.click(); 
            } else if (e.code === 'Equal') {
                volumeBar.value = parseFloat(volumeBar.value) + parseFloat(volumeBar.step);
                audio.volume = volumeBar.value;
                if (audio.volume === 0) {
                    muteBtn.textContent = "üîá";
                } else {
                    muteBtn.textContent = "üîä";
                }
                volumeValue.textContent = formatVolume(volumeBar.value);
            } else if (e.code === 'Minus') {
                volumeBar.value -= 0.01;
                audio.volume = volumeBar.value;
                if (audio.volume === 0) {
                    muteBtn.textContent = "üîá";
                } else {
                    muteBtn.textContent = "üîä";
                }
                volumeValue.textContent = formatVolume(volumeBar.value);
            }
        });

    </script>
</body>
</html> 